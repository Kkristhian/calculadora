<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!--

<html>
<head>
   <title>Calculadora</title>

   <link rel="stylesheet" type="text/css" media="screen" href="main.css" />
   <script src="main.js"></script>

</head>
<body>


<form name="calcform" method="post" action="">
   <fieldset>
      <legend>CALC EM JS</legend>

      <input type="text" name="visor" id="visor" />

      <table id="calc">
         <tr>
            <td><input type="button" name="num9" class="num" value="9" onclick="calcNum(9)" /></td>
            <td><input type="button" name="num8" class="num" value="8" onclick="calcNum(8)" /></td>
            <td><input type="button" name="num7" class="num" value="7" onclick="calcNum(7)" /></td>
            <td><input type="button" name="somar" class="oper" value="+" onclick="calcParse('somar')" /></td>
         </tr>
         <tr>
            <td><input type="button" name="num6" class="num" value="6" onclick="calcNum(6)" /></td>
            <td><input type="button" name="num5" class="num" value="5" onclick="calcNum(5)" /></td>
            <td><input type="button" name="num4" class="num" value="4" onclick="calcNum(4)" /></td>
            <td><input type="button" name="subtrair" class="oper" value="-" onclick="calcParse('subtrair')" /></td>
         </tr>
         <tr>
            <td><input type="button" name="num3" class="num" value="3" onclick="calcNum(3)" /></td>
            <td><input type="button" name="num2" class="num" value="2" onclick="calcNum(2)" /></td>
            <td><input type="button" name="num1" class="num" value="1" onclick="calcNum(1)" /></td>
            <td><input type="button" name="multiplicar" class="oper" value="*" onclick="calcParse('multiplicar')" /></td>
         </tr>
         <tr>
            <td><input type="button" name="num0" class="num" value="0" onclick="calcNum(0)" /></td>
            <td><input type="button" name="igual" class="num" value="=" onclick="calcParse('resultado')" /></td>
            <td><input type="button" name="limpar" class="num" value="AC" onclick="calcLimpar()" /></td>
            <td><input type="button" name="dividir" class="oper" value="/" onclick="calcParse('dividir')" /></td>
         </tr>
      </table>
   </fieldset>
</form>

</body>
</html> -->



<html>
<body>
	<form name="frm">

	<table width="200" cellpadding="3" cellspacing="5">
		<tr>
			<td colspan="3" align="center"><input type="text" name="tela" value="0"></td>
			<td><input type="reset" value="C"></td>
			<td><input class="operacao" type="button" value="=" id="igual" name="igual"></td>
		</tr>
		<tr>
			<td><input type="button" value="7" name="bt7" onclick="gravaBotao(7)"></td>
			<td><input type="button" value="8" name="bt8" onclick="gravaBotao(8)"></td>
			<td><input type="button" value="9" name="bt9" onclick="gravaBotao(9)"></td>
			<td><input class="operacao" type="button" value="+" name="soma"></td>
			<td><input class="operacao" type="button" value="-" name="menos"></td>
		</tr>
		<tr>
			<td><input type="button" value="4" name="bt4" onclick="gravaBotao(4)"></td>
			<td><input type="button" value="5" name="bt5" onclick="gravaBotao(5)"></td>
			<td><input type="button" value="6" name="bt6" onclick="gravaBotao(6)"></td>
			<td><input class="operacao" type="button" value="*" name="mult"></td>
			<td><input class="operacao" type="button" value="/" name="dv"></td>
		</tr>
		<tr>
			<td><input type="button" value="1" name="bt1" onclick="gravaBotao(1)"></td>
			<td><input type="button" value="2" name="bt2" onclick="gravaBotao(2)"></td>
			<td><input type="button" value="3" name="bt3" onclick="gravaBotao(3)"></td>
			<td><input type="button" value="0" name="bt0" onclick="gravaBotao(0)"></td>
			<td><input type="button" value="." id="ponto" name="ponto"></td>
		</tr>
	</table>
	</form>

<script type="text/javascript">
	let total = 0;
	let flag = false;
	let op = "";	
	function gravaBotao(digito) {
		if (flag) {
			document.frm.tela.value = digito;
			flag = false;
   		} else {
			if (document.frm.tela.value == "0")
				document.frm.tela.value = digito;
			else
				document.frm.tela.value += digito;
   		}
	}
    // adicionando função aos operadores
    let arrOp = Array.from(document.getElementsByClassName("operacao"));
	arrOp.forEach(function(btOp) {
		btOp.addEventListener("click", function() {
			op2 = this.value;
			if (document.frm.tela.value == ""){
				document.frm.tela.value ="0"; 
			} else {
				if (!flag && (op != "=" || op == "")){
					flag = true;
					if ("+" == op)
						total += parseFloat(document.frm.tela.value);
					else if ( '-' == op )
						total -= parseFloat(document.frm.tela.value);
					else if ( '/' == op )
						total /= parseFloat(document.frm.tela.value);
					else if ( '*' == op )
						total *= parseFloat(document.frm.tela.value);
					else
						total = parseFloat(document.frm.tela.value);
						document.frm.tela.value = total;
						op = op2;
				}
			}
		});
	});
    // adicionando a função ao ponto
    let ponto = document.getElementById("ponto");
    ponto.addEventListener("click", function() {
		let valor = document.frm.tela.value;
		if (flag) {
			valor = "0.";
			flag = false;
   		}
		else {
		if (valor.indexOf(".") == -1)
			valor += ".";
   		}
		document.frm.tela.value = valor;
	});
	
</script>

</body>
</html>